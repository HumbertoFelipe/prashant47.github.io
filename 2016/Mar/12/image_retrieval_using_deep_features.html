<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>Image Retrieval using Deep Features</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css">
    <link rel="stylesheet" href="/theme/css/main.365169ea.css">
    <link rel="stylesheet" href="/theme/webassets-external/5f88595a9ad2c678b16c0d171e6e0a71_print.css" media="print">
<meta property="og:title" content="Heuristic Intelligence - Image Retrieval using Deep Features">
  <meta property="og:description" content="Image Retrieval using Deep Features">
<meta property="og:url" content="/2016/Mar/12/image_retrieval_using_deep_features.html">
<meta name="twitter:card" content="summary">
<meta property="og:site_name" content="Heuristic Intelligence">
<meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-03-12T12:00:00+05:30">
    <meta property="article:tag" content="python">
    <meta property="article:tag" content="deep_learning">
  <meta property="article:section" content="GraphLab">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="nav">
        <div class="nav-left">
          <a class="nav-item is-brand title is-3"
             href="/">Heuristic Intelligence</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="nav has-shadow is-hidden-print">
  <div class="container">
    <div class="nav-center"></div>
    <span id="navToggle" class="nav-toggle">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="nav-right nav-menu">
          <a class="nav-item is-tab is-active"
             href="/category/graphlab.html">GraphLab</a>
          <a class="nav-item is-tab "
             href="/category/machine-learning.html">Machine Learning</a>
          <a class="nav-item is-tab "
             href="/category/misc.html">Misc</a>
          <a class="nav-item is-tab "
             href="/category/statistics.html">Statistics</a>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
<section id="content" class="body">
  <article>
    <h1 class="title">
      <a href="/2016/Mar/12/image_retrieval_using_deep_features.html" rel="bookmark"
         title="Permalink to Image Retrieval using Deep Features">Image Retrieval using Deep Features</a></h1>
<footer class="post-info">
  <abbr class="published" title="2016-03-12T12:00:00+05:30">
    Published <span class="is-info">Sat 12 March 2016</span>
    in <a href="/category/graphlab.html">GraphLab</a>
  </abbr>

    <p class="author">
      <em>by           Prashant Gonarkar
</em>
      <span class="tag is-small"><a href="/tag/python.html">python</a></span>
      <span class="tag is-small"><a href="/tag/deep_learning.html">deep_learning</a></span>
    </p>
  
</footer>    <div class="section"><p>In this article, we focused on using deep learning to create non-linear features to improve the performance of machine learning. We will also see how transfer learning techniques can be applied to use deep features learned with one dataset to get great performance on a different dataset. 
In this Ipython notebook, we are going to build new image retrieval models and explore their results on different parts of our image dataset</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">graphlab</span>
</pre></div>


<h1>Load the CIFAR-10 dataset</h1>
<div class="highlight"><pre><span></span><span class="c1"># CSV format datasets https://d396qusza40orc.cloudfront.net/phoenixassets/image_train_data.csv</span>
<span class="c1"># https://d396qusza40orc.cloudfront.net/phoenixassets/image_test_data.csv</span>
<span class="n">image_train</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SFrame</span><span class="p">(</span><span class="s1">&#39;coursera-notebooks/course-1/image_train_data&#39;</span><span class="p">)</span>
<span class="n">image_test</span> <span class="o">=</span>  <span class="n">graphlab</span><span class="o">.</span><span class="n">SFrame</span><span class="p">(</span><span class="s1">&#39;coursera-notebooks/course-1/image_test_data&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">deep_features</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image_array</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">24</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">bird</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.242871761322,<br>1.09545373917, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[73.0, 77.0, 58.0, 71.0,<br>68.0, 50.0, 77.0, 69.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.525087952614, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[7.0, 5.0, 8.0, 7.0, 5.0,<br>8.0, 5.0, 4.0, 6.0, 7.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.566015958786, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[169.0, 122.0, 65.0,<br>131.0, 108.0, 75.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">70</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.12979578972, 0.0, 0.0,<br>0.778194487095, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[154.0, 179.0, 152.0,<br>159.0, 183.0, 157.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">90</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">bird</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.71786928177, 0.0, 0.0,<br>0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[216.0, 195.0, 180.0,<br>201.0, 178.0, 160.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">97</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.57818555832, 0.0, 0.0,<br>0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[33.0, 44.0, 27.0, 29.0,<br>44.0, 31.0, 32.0, 45.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">107</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0,<br>0.220677852631, 0.0,  ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[97.0, 51.0, 31.0, 104.0,<br>58.0, 38.0, 107.0, 61.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">121</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">bird</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.23753464222, 0.0,<br>0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[93.0, 96.0, 88.0, 102.0,<br>106.0, 97.0, 117.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">136</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0, 0.0, 0.0,<br>0.0, 7.5737862587, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[35.0, 59.0, 53.0, 36.0,<br>56.0, 56.0, 42.0, 62.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">138</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">bird</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.658935725689, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[205.0, 193.0, 195.0,<br>200.0, 187.0, 193.0, ...</td>
    </tr>
</table>
[10 rows x 5 columns]<br/>
</div>

<h1>Train a nearest neighbour model for retrieving images using deep features</h1>
<div class="highlight"><pre><span></span><span class="n">knn_model</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">image_train</span><span class="p">,</span>
                                             <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deep_features&#39;</span><span class="p">],</span>
                                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">brute</span> <span class="n">force</span> <span class="n">nearest</span> <span class="n">neighbors</span> <span class="n">model</span> <span class="n">training</span><span class="o">.</span>
</pre></div>


<h1>Use image retrival model with deep features to find similar images</h1>
<div class="highlight"><pre><span></span><span class="n">graphlab</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="s1">&#39;ipynb&#39;</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">image_train</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
<span class="n">cat</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">7.002</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">338.929</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">384</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6910</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.9403137951</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39777</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.4634888975</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36870</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.7559623119</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41734</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.7866014148</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
</table>
[5 rows x 4 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_images_id</span><span class="p">(</span><span class="n">query_result</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">image_train</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">query_result</span><span class="p">[</span><span class="s1">&#39;reference_label&#39;</span><span class="p">],</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">cat_neighbours</span> <span class="o">=</span> <span class="n">get_images_id</span><span class="p">(</span><span class="n">knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">cat</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">8.562</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">307.947</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">cat_neighbours</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">car</span> <span class="o">=</span> <span class="n">image_train</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
<span class="n">car</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">get_images_id</span><span class="p">(</span><span class="n">knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">car</span><span class="p">))[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">7.241</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">289.806</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<h1>Just for fun, let's create a lambda function</h1>
<div class="highlight"><pre><span></span><span class="n">show_neightbors</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span><span class="n">get_images_id</span><span class="p">(</span><span class="n">knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">image_train</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">show_neightbors</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">8.657</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">303.641</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">show_neightbors</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">6.87</span><span class="n">ms</span>       <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">332.992</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">show_neightbors</span><span class="p">(</span><span class="mi">1222</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">6.621</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">299.262</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">show_neightbors</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.0498753</span>   <span class="o">|</span> <span class="mf">6.76</span><span class="n">ms</span>       <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">291.575</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<h2>Creating category-specific image retrieval models</h2>
<div class="highlight"><pre><span></span><span class="n">image_train_dog</span> <span class="o">=</span> <span class="n">image_train</span><span class="p">[</span><span class="n">image_train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dog&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">image_train_dog</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>509
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_train_cat</span> <span class="o">=</span> <span class="n">image_train</span><span class="p">[</span><span class="n">image_train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">image_train_cat</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>509
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_train_automobile</span> <span class="o">=</span> <span class="n">image_train</span><span class="p">[</span><span class="n">image_train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;automobile&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">image_train_automobile</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>509
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_train_bird</span> <span class="o">=</span> <span class="n">image_train</span><span class="p">[</span><span class="n">image_train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bird&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">image_train_bird</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>478
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_train_automobile</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">deep_features</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image_array</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">97</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.57818555832, 0.0, 0.0,<br>0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[33.0, 44.0, 27.0, 29.0,<br>44.0, 31.0, 32.0, 45.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">136</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0, 0.0, 0.0,<br>0.0, 7.5737862587, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[35.0, 59.0, 53.0, 36.0,<br>56.0, 56.0, 42.0, 62.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">302</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.583938002586, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[64.0, 52.0, 37.0, 85.0,<br>60.0, 40.0, 92.0, 66.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">312</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0,<br>0.392823398113, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[124.0, 126.0, 113.0,<br>124.0, 126.0, 113.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">323</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0,<br>4.42310428619, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[241.0, 241.0, 241.0,<br>238.0, 238.0, 238.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">536</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0, 0.0, 0.0,<br>0.0, 8.42903900146, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[164.0, 154.0, 154.0,<br>128.0, 119.0, 120.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">593</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.65033948421, 0.0, 0.0,<br>0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[231.0, 222.0, 227.0,<br>232.0, 217.0, 221.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">962</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0,<br>0.39552795887, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[255.0, 255.0, 255.0,<br>255.0, 255.0, 255.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">997</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0, 0.0, 0.0,<br>0.0, 8.04085636139, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[145.0, 148.0, 157.0,<br>131.0, 134.0, 145.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1421</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">automobile</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0, 0.0, 0.0,<br>0.359612941742, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[114.0, 95.0, 33.0,<br>118.0, 98.0, 26.0, 91.0, ...</td>
    </tr>
</table>
[10 rows x 5 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">dog_knn_model</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">image_train_dog</span><span class="p">,</span>
                                             <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deep_features&#39;</span><span class="p">],</span>
                                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">brute</span> <span class="n">force</span> <span class="n">nearest</span> <span class="n">neighbors</span> <span class="n">model</span> <span class="n">training</span><span class="o">.</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">cat_knn_model</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">image_train_cat</span><span class="p">,</span>
                                             <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deep_features&#39;</span><span class="p">],</span>
                                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">brute</span> <span class="n">force</span> <span class="n">nearest</span> <span class="n">neighbors</span> <span class="n">model</span> <span class="n">training</span><span class="o">.</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">automobile_knn_model</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">image_train_automobile</span><span class="p">,</span>
                                             <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deep_features&#39;</span><span class="p">],</span>
                                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">brute</span> <span class="n">force</span> <span class="n">nearest</span> <span class="n">neighbors</span> <span class="n">model</span> <span class="n">training</span><span class="o">.</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">bird_knn_model</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">image_train_bird</span><span class="p">,</span>
                                             <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deep_features&#39;</span><span class="p">],</span>
                                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">brute</span> <span class="n">force</span> <span class="n">nearest</span> <span class="n">neighbors</span> <span class="n">model</span> <span class="n">training</span><span class="o">.</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">deep_features</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image_array</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.13469004631, 0.0, 0.0,<br>0.0, 0.0366497635841, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[158.0, 112.0, 49.0,<br>159.0, 111.0, 47.0, ...</td>
    </tr>
</table>
[1 rows x 5 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">image_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">test_cat</span> <span class="o">=</span> <span class="n">image_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">cat_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">test_cat</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.196464</span>    <span class="o">|</span> <span class="mf">7.432</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">80.534</span><span class="n">ms</span>     <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16289</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.623719208</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45646</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.0068799284</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">32139</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.5200813436</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">25713</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.7548502521</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">331</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.8731228168</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
</table>
[5 rows x 4 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_images_id_cat</span><span class="p">(</span><span class="n">query_result</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">image_train_cat</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">query_result</span><span class="p">[</span><span class="s1">&#39;reference_label&#39;</span><span class="p">],</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">get_images_id_cat</span><span class="p">(</span><span class="n">cat_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">test_cat</span><span class="p">))[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.196464</span>    <span class="o">|</span> <span class="mf">7.881</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">83.519</span><span class="n">ms</span>     <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">test_cat_neighbours</span> <span class="o">=</span> <span class="n">cat_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">test_cat</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.196464</span>    <span class="o">|</span> <span class="mf">6.998</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">82.467</span><span class="n">ms</span>     <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">test_cat_neighbours</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16289</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.623719208</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45646</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.0068799284</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">32139</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.5200813436</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">25713</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.7548502521</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">331</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.8731228168</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
</table>
[5 rows x 4 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">image_train_cat</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">test_cat_neighbours</span><span class="p">[</span><span class="s1">&#39;reference_label&#39;</span><span class="p">],</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">deep_features</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image_array</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">331</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0,<br>0.510963916779, 0.0,  ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[45.0, 65.0, 92.0, 72.0,<br>95.0, 110.0, 106.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16289</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.964287519455, 0.0,<br>0.0, 0.0, 1.12515509129, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[215.0, 219.0, 231.0,<br>215.0, 219.0, 232.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">25713</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.536971271038, 0.0,<br>0.0, 0.0894458889961, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[228.0, 222.0, 236.0,<br>224.0, 213.0, 222.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">32139</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[1.29409468174, 0.0, 0.0,<br>0.513800263405, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[217.0, 220.0, 205.0,<br>221.0, 227.0, 218.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45646</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">cat</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.983677506447, 0.0,<br>0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[51.0, 42.0, 26.0, 56.0,<br>47.0, 31.0, 59.0, 50.0, ...</td>
    </tr>
</table>
[5 rows x 5 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">nearest_cat_sframe</span> <span class="o">=</span> <span class="n">image_train_cat</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">test_cat_neighbours</span><span class="p">[</span><span class="s1">&#39;reference_label&#39;</span><span class="p">],</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">nearest_cat_sframe</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">get_images_id</span><span class="p">(</span><span class="n">dog_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">test_cat</span><span class="p">))[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.196464</span>    <span class="o">|</span> <span class="mf">6.663</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">79.548</span><span class="n">ms</span>     <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">nearest_dog</span> <span class="o">=</span> <span class="n">dog_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">test_cat</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">pairwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mf">0.196464</span>    <span class="o">|</span> <span class="mf">7.628</span><span class="n">ms</span>      <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span>         <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">84.028</span><span class="n">ms</span>     <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">nearest_dog</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16976</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.4642628784</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">13387</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.5666832169</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35867</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.6047267079</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44603</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.7065585153</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6094</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.5113254907</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
</table>
[5 rows x 4 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">image_train_dog</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">nearest_dog</span><span class="p">[</span><span class="s1">&#39;reference_label&#39;</span><span class="p">],</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">deep_features</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">image_array</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6094</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.470533549786, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[91.0, 98.0, 71.0, 138.0,<br>123.0, 63.0, 135.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">13387</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.366494178772, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[255.0, 255.0, 255.0,<br>255.0, 255.0, 255.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16976</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.755595386028, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[16.0, 17.0, 11.0, 18.0,<br>19.0, 13.0, 20.0, 21.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35867</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.305321395397, 0.0,<br>0.0, 0.0, 0.0, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[101.0, 93.0, 9.0, 93.0,<br>88.0, 9.0, 90.0, 86.0, ...</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44603</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Height: 32 Width: 32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">dog</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[0.0, 0.0, 0.0, 0.0, 0.0,<br>0.0, 11.2646656036, 0.0, ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">[8.0, 25.0, 9.0, 29.0,<br>39.0, 22.0, 66.0, 75.0, ...</td>
    </tr>
</table>
[5 rows x 5 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">image_train_dog</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">nearest_dog</span><span class="p">[</span><span class="s1">&#39;reference_label&#39;</span><span class="p">],</span><span class="s1">&#39;id&#39;</span><span class="p">)[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h2>calculating mean distances from neighbours</h2>
<div class="highlight"><pre><span></span><span class="n">test_cat_neighbours</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16289</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.623719208</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45646</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.0068799284</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">32139</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.5200813436</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">25713</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.7548502521</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">331</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.8731228168</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
</table>
[5 rows x 4 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">test_cat_neighbours</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">nearest_dog</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">16976</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.4642628784</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">13387</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.5666832169</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35867</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.6047267079</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44603</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.7065585153</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6094</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.5113254907</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
</table>
[5 rows x 4 columns]<br/>
</div>

<div class="highlight"><pre><span></span><span class="n">nearest_dog</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<h2>Computing nearest neighbors accuracy</h2>
<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">image_test</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>4000
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sketch_summary</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>+------------------+-------+----------+
|       item       | value | is exact |
+------------------+-------+----------+
|      Length      |  4000 |   Yes    |
| # Missing Values |   0   |   Yes    |
| # unique values  |   4   |    No    |
+------------------+-------+----------+

Most frequent items:
+-------+------------+------+------+------+
| value | automobile | cat  | bird | dog  |
+-------+------------+------+------+------+
| count |    1000    | 1000 | 1000 | 1000 |
+-------+------------+------+------+------+
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_test_cat</span> <span class="o">=</span> <span class="n">image_test</span><span class="p">[</span><span class="n">image_test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cat&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">image_test_cat</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>1000
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_test_dog</span> <span class="o">=</span> <span class="n">image_test</span><span class="p">[</span><span class="n">image_test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dog&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_test_automobile</span> <span class="o">=</span> <span class="n">image_test</span><span class="p">[</span><span class="n">image_test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;automobile&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">image_test_bird</span> <span class="o">=</span> <span class="n">image_test</span><span class="p">[</span><span class="n">image_test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bird&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_cat_neighbors</span> <span class="o">=</span> <span class="n">cat_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">image_test_dog</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">blockwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">max</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">data</span> <span class="n">block</span><span class="o">:</span> <span class="mi">7668</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">reference</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">query</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">1000</span>         <span class="o">|</span> <span class="mi">509000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">791.418</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span> <span class="mi">509000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">794.145</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_cat_neighbors</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.4196077068</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">30606</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.8353268874</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5545</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.9763410854</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">19631</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.5750072914</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7493</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.778824791</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">47044</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35.1171578292</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">13918</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.6095830913</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">10981</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.9036867306</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45456</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.0674700168</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44673</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">42.7258732951</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
</table>
[1000 rows x 4 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>

<div class="highlight"><pre><span></span><span class="n">dog_dog_neighbors</span> <span class="o">=</span> <span class="n">dog_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">image_test_dog</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">blockwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">max</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">data</span> <span class="n">block</span><span class="o">:</span> <span class="mi">7668</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">reference</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">query</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">1000</span>         <span class="o">|</span> <span class="mi">509000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">790.626</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span> <span class="mi">509000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">793.114</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_dog_neighbors</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">49803</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33.4773590373</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5755</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">32.8458495684</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">20715</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35.0397073189</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">13387</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33.9010327697</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">12089</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.4849250909</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6094</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.945165344</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3431</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.0957278345</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6184</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.7696131032</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2167</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35.1089144603</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7776</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">43.2422832585</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
</table>
[1000 rows x 4 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>

<div class="highlight"><pre><span></span><span class="n">dog_automobile_neighbors</span> <span class="o">=</span> <span class="n">automobile_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">image_test_dog</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">blockwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">max</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">data</span> <span class="n">block</span><span class="o">:</span> <span class="mi">7668</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">reference</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">query</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">1000</span>         <span class="o">|</span> <span class="mi">509000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">797.994</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span> <span class="mi">509000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">800.718</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_automobile_neighbors</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33859</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.9579761457</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2046</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">46.0021331807</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">19594</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">42.9462290692</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">11000</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.6866060048</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">19594</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.2269664935</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">49314</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.5845117698</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40822</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45.1067352961</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44997</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.3221140974</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33859</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.8244654995</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33859</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45.4976929401</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
</table>
[1000 rows x 4 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>

<div class="highlight"><pre><span></span><span class="n">dog_bird_neighbors</span> <span class="o">=</span> <span class="n">bird_knn_model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">image_test_dog</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">PROGRESS</span><span class="o">:</span> <span class="n">Starting</span> <span class="n">blockwise</span> <span class="n">querying</span><span class="o">.</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">max</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">data</span> <span class="n">block</span><span class="o">:</span> <span class="mi">7668</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">reference</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">query</span> <span class="n">data</span> <span class="n">blocks</span><span class="o">:</span> <span class="mi">1</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Query</span> <span class="n">points</span> <span class="o">|</span> <span class="err">#</span> <span class="n">Pairs</span> <span class="o">|</span> <span class="o">%</span> <span class="n">Complete</span><span class="o">.</span> <span class="o">|</span> <span class="n">Elapsed</span> <span class="n">Time</span> <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="mi">1000</span>         <span class="o">|</span> <span class="mi">478000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">765.493</span><span class="n">ms</span>    <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">|</span> <span class="n">Done</span>         <span class="o">|</span> <span class="mi">478000</span>  <span class="o">|</span> <span class="mi">100</span>         <span class="o">|</span> <span class="mf">768.23</span><span class="n">ms</span>     <span class="o">|</span>
<span class="n">PROGRESS</span><span class="o">:</span> <span class="o">+--------------+---------+-------------+--------------+</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_bird_neighbors</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">query_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">reference_label</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">distance</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44658</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.7538647304</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9215</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.3382958925</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36675</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.6157590853</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">12582</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.0892269954</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36122</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.272288694</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8736</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.1462089236</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38991</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.523040106</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">44177</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.1947918393</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4549</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.1567131661</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40225</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45.5597962603</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
</table>
[1000 rows x 4 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>

<div class="highlight"><pre><span></span><span class="n">dog_distances</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SFrame</span><span class="p">({</span><span class="s1">&#39;dog-dog&#39;</span><span class="p">:</span> <span class="n">dog_dog_neighbors</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">],</span><span class="s1">&#39;dog-cat&#39;</span><span class="p">:</span> <span class="n">dog_cat_neighbors</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">],</span> 
                                <span class="s1">&#39;dog-automobile&#39;</span><span class="p">:</span> <span class="n">dog_automobile_neighbors</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">],</span> <span class="s1">&#39;dog-bird&#39;</span><span class="p">:</span> <span class="n">dog_bird_neighbors</span><span class="p">[</span><span class="s1">&#39;distance&#39;</span><span class="p">]})</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_distances</span>
</pre></div>


<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">dog-automobile</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">dog-bird</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">dog-cat</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">dog-dog</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.9579761457</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.7538647304</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.4196077068</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33.4773590373</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">46.0021331807</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.3382958925</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.8353268874</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">32.8458495684</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">42.9462290692</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.6157590853</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">36.9763410854</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35.0397073189</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.6866060048</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.0892269954</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.5750072914</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">33.9010327697</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.2269664935</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.272288694</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.778824791</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.4849250909</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.5845117698</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.1462089236</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35.1171578292</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">34.945165344</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45.1067352961</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.523040106</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.6095830913</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.0957278345</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.3221140974</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.1947918393</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">39.9036867306</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">37.7696131032</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">41.8244654995</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">40.1567131661</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">38.0674700168</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">35.1089144603</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45.4976929401</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">45.5597962603</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">42.7258732951</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">43.2422832585</td>
    </tr>
</table>
[1000 rows x 4 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</div>

<div class="highlight"><pre><span></span><span class="n">dog_distances</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>{&#39;dog-automobile&#39;: 46.002133180677895,
 &#39;dog-bird&#39;: 41.3382958924861,
 &#39;dog-cat&#39;: 38.83532688735544,
 &#39;dog-dog&#39;: 32.845849568405555}
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_dog_correct</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;dog-dog&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">is_dog_correct</span><span class="p">(</span><span class="n">dog_distances</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>1
</pre></div>


<div class="highlight"><pre><span></span><span class="n">is_dog_correct</span><span class="p">(</span><span class="n">dog_distances</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>0
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_distances</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_dog_correct</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dtype</span><span class="o">:</span> <span class="n">int</span>
<span class="n">Rows</span><span class="o">:</span> <span class="mi">1000</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">...</span> <span class="o">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">dog_distances</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_dog_correct</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>678
</pre></div>


<div class="highlight"><pre><span></span><span class="n">accuracy</span> <span class="o">=</span> <span class="n">dog_distances</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_dog_correct</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">float</span> <span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">accuracy</span>
</pre></div>


<div class="highlight"><pre><span></span>0.678
</pre></div>


<p><br><br/>
<em>Credits <a href="https://www.coursera.org/specializations/machine-learning">Machine Learning Foundations: A Case Study Approach</a></em></p></div>

  </article>
</section>

<script type="application/ld+json">
  {"author": {"name": "Prashant Gonarkar", "@type": "Person"}, "headline": "Image Retrieval using Deep Features", "@context": "http://schema.org", "articleSection": "GraphLab", "description": "Image Retrieval using Deep Features", "datePublished": "2016-03-12T12:00:00+05:30", "mainEntityOfPage": {"@id": "/2016/Mar/12/image_retrieval_using_deep_features.html", "@type": "WebPage"}, "@type": "BlogPosting"}
</script>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
          <p class="menu-label">Links</p>
          <ul class="menu-list">
                <li><a                        href="/pages/about.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">About</span>
                </a></li>
                <li><a                        href="/pages/projects.html">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">Projects</span>
                </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="https://github.com/prashant47">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text">GitHub</span>
    </a></li>
    <li><a href="http://facebook.com/prashantgonarkar">
      <span class="icon is-small">
          <i class="fa fa-facebook-official fa-fw"></i>
      </span>
      <span class="link-text">Facebook</span>
    </a></li>
    <li><a href="https://twitter.com/pgonarkar">
      <span class="icon is-small">
          <i class="fa fa-twitter fa-fw"></i>
      </span>
      <span class="link-text">Twitter</span>
    </a></li>
</ul>          <p class="menu-label">License</p>
          
<ul class="menu-list">
  <li>
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
      <span class="icon is-small">
        <i class="fa fa-creative-commons fa-fw"></i>
      </span>
      <span>CC BY-SA 4.0</span>
    </a>
  </li>
</ul>

      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
 <p class="subtitle">The question of whether a computer can think is no more interesting than the question of whether a submarine can swim. Edsger W. Dijkstra</p>    <p><a href="https://github.com/textbook/bulrush">Bulrush</a> theme for
        <a href="https://blog.getpelican.com/">Pelican</a>
      | <span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5
      | <span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3
    </p>
  </div>
</footer>

<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'nav-right nav-menu') {
      nav.className = 'nav-right nav-menu is-active';
    } else {
      nav.className = 'nav-right nav-menu';
    }
  });
</script>
</body>
</html>